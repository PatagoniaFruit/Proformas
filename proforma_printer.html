<!DOCTYPE html>


<div class="table-wrapper">
<table class="details-table">
<thead>
<tr>
<th class="col-cantidad">CANTIDAD</th>
<th class="col-detalle">DETALLE</th>
<th class="col-punitario">P.UNITARIO</th>
<th class="col-total">TOTAL</th>
</tr>
</thead>
<tbody>${rowsHtml}</tbody>
</table>
</div>


<div style="flex-grow:1;min-height:20px;"></div>


<section class="totals-section">
<div class="totals-glosa">
<span style="font-weight:700;">GLOSA:</span>
<div style="font-weight:400;padding-left:10px;margin-top:6px;">${header.GLOSA || ''}</div>
</div>
<div class="totals-table">
<table>
<tbody>
<tr><td class="label">VALOR NETO</td><td class="value">${currencyFormatter.format(valorNeto)}</td></tr>
<tr><td class="label">19% IVA</td><td class="value">${currencyFormatter.format(iva)}</td></tr>
<tr><td class="label">TOTAL</td><td class="value">${currencyFormatter.format(total)}</td></tr>
</tbody>
</table>
</div>
</section>


<footer class="proforma-footer">
<div class="footer-column">
<span style="font-weight:700;">RECIBI CONFORME</span>
<div class="footer-line"><span class="label">R.U.T.:</span><span class="data">&nbsp;</span></div>
</div>
<div class="footer-column">
<div class="footer-line"><span class="label">NOMBRE:</span><span class="data">&nbsp;</span></div>
<div class="footer-line" style="margin-top:10px;"><span class="label">FIRMA:</span><span class="data">&nbsp;</span></div>
</div>
</footer>
`;
return page;
}


function printSelected() {
const selected = document.querySelectorAll('.proforma-checkbox:checked');
const printArea = document.getElementById('printArea');
printArea.innerHTML = '';
if (!selected.length) { showMessage('error', 'Debes seleccionar al menos una proforma.'); return; }
selected.forEach(cb => {
const id = cb.value; const data = proformaData[id];
if (data) printArea.appendChild(createProformaPage(data, id));
});
window.print();
}
</script>
</body>
</html>
